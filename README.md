#  ุทุจููโุจูุฏ ูุฏุฑู CNN ุจุง ุฎุท ูููู ุจูููโ `tf.data`

ุงู ูพุฑูฺู ฺฉ ุทุจููโุจูุฏ ุชุตูุฑ ุณฺฏ ู ฺฏุฑุจู ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฉ ุดุจฺฉูโ ุนุตุจ ฺฉุงููููุดู (CNN) ุงุณุชุ ุงูุง ุจุง ุชูุฑฺฉุฒ ุจุฑ **ุฑูุดโูุง ูุฏุฑู ู ุจูููโ TensorFlow 2.x**.

ุจุฑุฎูุงู ุงุณุชูุงุฏู ุงุฒ `ImageDataGenerator` ูุฏูุ ุงู ูพุฑูฺู ุงุฒ ุฎุท ููููโ ุฏุงุฏูโ `tf.data` ุจุฑุง ุจุงุฑฺฏุฐุงุฑุ ูพุดโูพุฑุฏุงุฒุด ู ุชุบุฐูโ ุฏุงุฏูโูุง ุจู GPU ุจู ุตูุฑุช ุจููู ุงุณุชูุงุฏู ูโฺฉูุฏ.

**ูุชุฌู ููุง: ุงู ูุฏู ุจุง ุงุณุชูุงุฏู ุงุฒ `EarlyStopping` ุจุฑุง ุฌููฺฏุฑ ุงุฒ Overfittingุ ุจู ุฏูุช ูุงูุน ธฒูช ุจุฑ ุฑู ุฏุงุฏูโูุง ุขุฒูุงุด ุฏุณุช ุงูุช.**

---

##  ุฏุชุงุณุช (Dataset)

ุงู ูพุฑูฺู ุงุฒ ุฏุชุงุณุช ูุนุฑูู **"Dogs vs. Cats"** ฺฉู ุฏุฑ ุฑูุงุจุช Kaggle ูุนุฑู ุดุฏุ ุงุณุชูุงุฏู ูโฺฉูุฏ.

* **ููุจุน:** ุดูุง ูโุชูุงูุฏ ุฏุชุงุณุช ฺฉุงูู (train ู test) ุฑุง ูุณุชููุงู ุงุฒ [**ูุจโุณุงุช ูุงฺฉุฑูุณุงูุช (ููฺฉ ุฏุงูููุฏ)**](https://www.microsoft.com/en-us/download/details.aspx?id=54765) ุฏุงูููุฏ ฺฉูุฏ.
* **ุณุงุฎุชุงุฑ ููุฑุฏ ูุงุฒ:** ฺฉุฏ ุงูุชุธุงุฑ ุฏุงุฑุฏ ฺฉู ุฏุงุฏูโูุง ุฏุฑ ูพูุดูโุง ุจู ูุงู `dataset/` ุจุง ุงู ุณุงุฎุชุงุฑ ูุฑุงุฑ ฺฏุฑูุฏ:
    ```
    dataset/
    โโโ training_set/
    โ   โโโ cats/
    โ   โโโ dogs/
    โโโ test_set/
        โโโ cats/
        โโโ dogs/
    ```
---

## โ๏ธ ูุฑุขูุฏ ู ูุชุฏูููฺ (Workflow)

### ฑ. ุฎุท ููููโ ุฏุงุฏู ุจููู (`tf.data`)
ุจู ุฌุง `ImageDataGenerator`ุ ุงุฒ `tf.keras.utils.image_dataset_from_directory` ุจุฑุง ุจุงุฑฺฏุฐุงุฑ ูุณุชูู ุฏุงุฏูโูุง ุงุฒ ุฏุณฺฉ ุงุณุชูุงุฏู ุดุฏ.

### ฒ. ุจูููโุณุงุฒ ุนููฺฉุฑุฏ (Caching & Prefetching)
ุจุฑุง ุจู ุญุฏุงฺฉุซุฑ ุฑุณุงูุฏู ุชูุงู GPU ู ุฌููฺฏุฑ ุงุฒ ยซฺฏููฺฏุงูยป (bottleneck) ูุฑูุฏ/ุฎุฑูุฌุ ุฎุท ููููโ ุฏุงุฏู ุจุง ุฏู ุชุงุจุน ฺฉูุฏ ุจููู ุดุฏ:
* **`.cache()`**: ุฏุงุฏูโูุง ูพุณ ุงุฒ ุงููู ุจุงุฑ ุฎูุงูุฏู ุดุฏู ุงุฒ ุฏุณฺฉุ ุฏุฑ ุญุงูุธูโ RAM ฺฉุด ูโุดููุฏ ุชุง ุฏุฑ Epochูุง ุจุนุฏ ุจุง ุณุฑุนุช ุจุงูุง ุฏุฑ ุฏุณุชุฑุณ ุจุงุดูุฏ.
* **`.prefetch(AUTOTUNE)`**: ุจู CPU ุงุฌุงุฒู ูโุฏูุฏ ุชุง ุฏุณุชูโ (Batch) ุจุนุฏ ุฏุงุฏูโูุง ุฑุง **ููุฒูุงู** ฺฉู GPU ุฏุฑ ุญุงู ูพุฑุฏุงุฒุด ุฏุณุชูโ ูุนู ุงุณุชุ ุขูุงุฏู ฺฉูุฏ.

### ณ. ูพุดโูพุฑุฏุงุฒุด ู ุงูุฒุงุด ุฏุงุฏู (Layers)
* **ูุฑูุงูโุณุงุฒ:** ฺฉ ูุงูโ `layers.Rescaling(1./255)` ุจู ุนููุงู ุจุฎุด ุงุฒ ูุฏู (ุง ุฏุฑ ุชุงุจุน `prepare`) ุจุฑุง ูุฑูุงูโุณุงุฒ ูพฺฉุณูโูุง ุงุณุชูุงุฏู ุดุฏ.
* **ุงูุฒุงุด ุฏุงุฏู (Augmentation):** ูุงูโูุง `RandomFlip`, `RandomRotation`, ู `RandomZoom` ุฏุฑ ุชุงุจุน `prepare` ุชุนุฑู ุดุฏูุฏ ุชุง ููุท ุจุฑ ุฑู ุฏุงุฏูโูุง ุขููุฒุด ุงุนูุงู ุดููุฏ.

### ด. ูุนูุงุฑ ูุฏู ู ุฑฺฏููุงุฑุฒุดู
ูุฏู CNN ุดุงูู ณ ุจููฺฉ `Conv2D` ู `MaxPool2D` ุจูุฏ ฺฉู ุจู ฺฉ ุณุฑ ุทุจููโุจูุฏ (`Flatten`, `Dense`, `Dropout`) ูุชุตู ูโุดุฏ.
* **`Dropout(0.25)`**: ุจุฑุง ุฌููฺฏุฑ ุงุฒ Overfittingุ ฺฉ ูุงูโ Dropout ุจุง ูุฑุฎ ฒตูช ุงุณุชูุงุฏู ุดุฏ.

### ต. ุขููุฒุด ููุดููุฏ ุจุง `EarlyStopping`
ุจุฑุง ูพุฏุง ฺฉุฑุฏู ุจูุชุฑู ูุฏู ู ุฌููฺฏุฑ ุงุฒ ุงุชูุงู ููุช ู Overfitting:
* **`EarlyStopping`**: ุขููุฒุด ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ูุชููู ุดุฏุ ุฒูุงู ฺฉู `val_loss` (ุฎุทุง ุชุณุช) ุจุฑุง **ฑฐ ุฏูุฑ (patience=10)** ูุชูุงู ุจูุจูุฏ ูพุฏุง ูฺฉุฑุฏ.
* **`restore_best_weights=True`**: ูุฏู ููุง ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุจู ูุฒูโูุง **ุจูุชุฑู Epoch** (ูู ุขุฎุฑู Epoch) ุจุงุฒฺฏุฑุฏุงูุฏู ุดุฏุ ฺฉู ููุฌุฑ ุจู ุฏูุช **ธฒูช** ุดุฏ.

---

##  ฺฉุชุงุจุฎุงููโูุง ุงุณุชูุงุฏูโุดุฏู

* **TensorFlow 2.x** (`tf.data`, `tf.keras`)
* **Scikit-learn** (ุจุฑุง `confusion_matrix` ู `classification_report`)
* **Numpy**
* **Matplotlib**

---

## ๐ ูุญูู ุงุฌุฑุง (How to Run)

1.  ุงู ุฑูพุงุฒุชูุฑ ุฑุง `clone` ฺฉูุฏ.
2.  ุฏุชุงุณุช ุฑุง ุงุฒ [ููฺฉ ูุงฺฉุฑูุณุงูุช](https://www.microsoft.com/en-us/download/details.aspx?id=54765) ุฏุงูููุฏ ฺฉูุฏ.
3.  ูพูุดูโูุง `training_set` ู `test_set` ุฑุง ุฏููุงู ุทุจู ุณุงุฎุชุงุฑ ฺฉู ุฏุฑ ุจุฎุด ุฏุชุงุณุช ุชูุถุญ ุฏุงุฏู ุดุฏุ ุฏุฑ ูพูุดูโ `dataset` ูุฑุงุฑ ุฏูุฏ.
4.  ููุชโุจูฺฉ ุฌููพุชุฑ (`.ipynb`) ุฑุง ุงุฌุฑุง ฺฉูุฏ.
